@using DragonSpark.Application.AspNet.Entities.Queries.Runtime.Pagination
@using DragonSpark.Application.Runtime.Operations
@using DragonSpark.Presentation.Components.Content

@typeparam T

@inherits DragonSpark.Presentation.Components.Content.Templates.ManyActiveContentTemplateComponentBase<IDataRequest>

<ReportingContentView TIn="IDataRequest" TOut="IDataRequest"
	Content="@_subject"
	Reporter="@Reporter"
	LoadingTemplate="@LoadingTemplate"
	ExceptionTemplate="@ExceptionTemplate"
	NotFoundTemplate="@NotFoundTemplate"
>
	@ChildContent(context)
</ReportingContentView>

@code {
    IDataRequest? _subject;

	[Parameter]
	public IPages<T> Content
	{
		get => _content;
		set
		{
			if (_content != value)
			{
				_content = value;
                _subject = null;
			}
		}
	}	IPages<T> _content = null!;

	[Parameter]
	public IDataRequests<T> Requests { get; set; } = DataRequests<T>.Default;

	[Parameter]
	public IReporter<IDataRequest> Reporter { get; set; } = Queries.Reporter.Default;

	protected override void OnParametersSet()
	{
        _subject ??= Requests.Get(Content);
		base.OnParametersSet();
	}
}