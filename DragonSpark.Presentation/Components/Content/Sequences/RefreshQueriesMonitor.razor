@typeparam T

@using DragonSpark.Presentation.Components.Eventing
@using DragonSpark.Application.Entities.Queries.Runtime

@implements DragonSpark.Presentation.Components.Eventing.IHandle<RefreshQueriesMessage<T>>
@implements IDisposable

@inject IEventAggregator Events

@code {
	[Parameter]
	public IQueries<T> Topic { get; set; } = default!;

	[Parameter]
	public EventCallback<IQueries<T>> Updated { get; set; }

	protected override void OnInitialized()
	{
		base.OnInitialized();
		Events.Subscribe(this);
	}

	public Task HandleAsync(RefreshQueriesMessage<T> message)
		=> message.Subject == Topic ? Updated.InvokeAsync(Topic) : Task.CompletedTask;

	public void Dispose()
	{
		Events.Unsubscribe(this);
	}
}
