@using DragonSpark.Presentation.Environment.Browser
@using DragonSpark.Compose

@inject IEvaluate Model

@code {
	[Parameter]
	public RenderFragment ChildContent { get; set; } = default!;

	[Parameter]
	public string Type { get; set; } = "text/javascript";

	[Parameter]
	public bool Force { get; set; }

	protected override bool ShouldRender() => Force;

	// ReSharper disable once FlagArgument
	protected override Task OnAfterRenderAsync(bool firstRender)
	{
		if ((firstRender || Force) && Type == "text/javascript")
		{
			var script = ChildContent.Text();
			return Model.Get(script).AsTask();
		}
		return Task.CompletedTask;
	}
}