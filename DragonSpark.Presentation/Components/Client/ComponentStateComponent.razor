@using DragonSpark.Presentation.Environment.Browser
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@using DragonSpark.Presentation.Components.Content.Rendering
@typeparam T

@inherits ComponentStateComponentBase<T>

@inject IContentKey Key

@ChildContent(Store)

@code
{
    [Parameter]
    public ProtectedBrowserStorage Storage { get; set; } = default!;

    IClientVariable<T> Store { get; set; } = default!;

    protected override void OnInitialized()
    {
        Store = new ComponentStateVariable<T>($"{ProvidedKey ?? Key.Get(Owner)}/{Qualifier}", Storage);
        base.OnInitialized();
    }
}